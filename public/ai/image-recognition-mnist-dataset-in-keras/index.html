<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">

<meta name="keywords" content="blog, theme, 博客, 个人博客, 文字, hugo, 原创"/>
<meta name="description" content="Hugo theme notepadium mod, a simple hugo theme for blogger"/>
<meta name="author" content="理头张">
<meta name="copyright"content="理头张">
<meta http-equiv="content-language" content="zh,en">

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff"><title>Image Recognition (MNIST dataset) in Keras&nbsp;&ndash;&nbsp;iPark memoization</title><link rel="preconnect" href="https://cdn.jsdelivr.net/" crossorigin>
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net/">
<link rel="dns-prefetch" href="https://fonts.gstatic.com/"><link rel="preload" href="/css/core.min.fdf2dd6d920f0ce72f788d5ff5a1f4feb164ffab9b790386b133d340e7b51bbe8fba56050bf2e4919342447cbccdffbd.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="/css/core.min.fdf2dd6d920f0ce72f788d5ff5a1f4feb164ffab9b790386b133d340e7b51bbe8fba56050bf2e4919342447cbccdffbd.css" integrity="sha384-/fLdbZIPDOcveI1f9aH0/rFk/6ubeQOGsTPTQOe1G76PulYFC/LkkZNCRHy8zf&#43;9"></noscript>
<style type="text/css">*,::before,::after{margin:0;padding:0;box-sizing:border-box}html{font-family:-system-ui,-apple-system,BlinkMacSystemFont,helvetica neue,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol;font-size:17px;font-weight:400;line-height:1.7;scroll-behavior:smooth;transition:color .3s,background-color .3s;word-wrap:break-word;-webkit-text-size-adjust:100%}html[data-theme=dark] img{opacity:.65;transition:opacity .5s ease-in-out}html{background:#fff;--site-name-color:#3f4b67;--color-primary:#005ab4;--link-underline:#90cff9;--blockquote-border-left:6px solid #0051a2;--block-background-color:#f7faff;--pag-background-color:rgba(0, 122, 255, .5);--box-shadow:1px 1px 2px rgba(0,0,0,.125);--title-color:#303033;--body-color:#444}html[data-theme=dark]{background:#22272e;--site-name-color:#539bf5;--color-primary:#99bde1;--link-underline:#0051a2;--blockquote-border-left:6px solid #5176bf;--block-background-color:#002c58;--box-shadow:none;--title-color:#dadada;--body-color:#e9e9e9}h1,h2,h3,h4,h5,h6{font-weight:600;line-height:1.3;margin-block-start:0;margin-block-end:0}h1{font-size:26px}h2{font-size:24px}h3{font-size:22px}section>h1{color:var(--title-color)}a{color:var(--color-primary);text-decoration-thickness:.15rem;text-decoration-color:var(--link-underline)}a:hover{text-decoration-color:var(--color-primary)}.wrapper{display:grid;grid-template-columns:1fr min(65ch,calc(100% - 64px))1fr;grid-column-gap:32px}.wrapper>section{grid-column:2}.header{margin:20px 0;display:-webkit-flex;display:flex;flex-wrap:wrap;text-align:initial;padding:15px 0;border-bottom:1px solid #f0f0f0;justify-content:space-between;align-items:baseline}.site-name{display:inline-block;font-weight:600;font-size:21px;color:var(--site-name-color)}.site-logo{height:38px;border-radius:3px;vertical-align:middle;margin-right:8px}.nav-item{display:inline-block;font-size:18px;padding:4px 6px;margin:2px 3px 2px 0;line-height:1.5;white-space:nowrap}.data-theme-btn{border:none;vertical-align:middle;transition:.3s;background-color:Transparent;background-repeat:no-repeat;cursor:pointer;overflow:hidden;outline:none;padding-right:0;padding-left:0}html[data-theme=light] .light-hidden{display:none}html[data-theme=dark] .dark-hidden{display:none}.note-list{margin:0;padding:0;list-style:none}.note-list .item{position:relative;width:100%;margin-top:25px}.note-list .item:last-child{border:0!important}.note-title{font-size:19px;font-weight:700}.note-date,.note-content{font-size:15px;text-decoration:none;color:var(--body-color)}.note-content,.note-imgs,.note-labels{margin-top:4px;text-align:justify;text-justify:inter-word}.article-tag,.article-category{display:inline-block;font-size:15px;line-height:1;padding:4px 6px;margin:2px 3px 2px 0;white-space:nowrap;border-radius:3px}.article-category{color:#3a8c42}.article-category .hashtag,.article-tag .hashtag{font-weight:700;opacity:.5}.footer{font-size:13px;margin:40px 0 20px}.footer-wrap{text-align:center;color:var(--body-color)}.tag-cloud{margin:2em 0 3em;text-align:center}.tag-cloud-tags{display:inline-block;position:relative;margin:5px;word-wrap:break-word;overflow-wrap:break-word}.archive-year{font-size:20px;font-weight:800;color:var(--title-color);margin-top:20px;margin-bottom:10px}.archive-list{list-style:none}.archive-date{flex:0 0 100px;color:var(--title-color)}.archive-text{color:var(--body-color)}ul.archive-list li{display:flex}.article-containter{margin-bottom:20px}.article-header{margin:20px 0}.article-date{font-size:14px;margin-top:20px;color:#838387}.markdown-body{color:var(--body-color)}.markdown-body p{margin-top:0;margin-bottom:20px}.pagination{display:block;text-align:center;margin:20px 0 40px}.pagination ul{display:inline-block;list-style:none;font-weight:600;padding:0;margin:0}.pagination ul li{display:inline}.pagination ul li a{color:var(--color-primary);float:left;padding:8px 16px;text-decoration:none}.pagination ul li a:hover:not(.active){background-color:var(--pag-background-color)}.pagination ul li a.active{background-color:var(--color-primary);color:var(--block-background-color)}@font-face{font-family:averia sans libre;font-style:italic;font-weight:300;font-display:swap;src:local('Averia Sans Libre Light Italic'),local('AveriaSansLibre-LightItalic'),url(https://fonts.gstatic.com/s/averiasanslibre/v8/ga6caxZG_G5OvCf_rt7FH3B6BHLMEdVLKisSH5DdLw.ttf)format('truetype')}@font-face{font-family:averia sans libre;font-style:italic;font-weight:400;font-display:swap;src:local('Averia Sans Libre Italic'),local('AveriaSansLibre-Italic'),url(https://fonts.gstatic.com/s/averiasanslibre/v8/ga6RaxZG_G5OvCf_rt7FH3B6BHLMEdVLIoAwDw.ttf)format('truetype')}@font-face{font-family:averia sans libre;font-style:italic;font-weight:700;font-display:swap;src:local('Averia Sans Libre Bold Italic'),local('AveriaSansLibre-BoldItalic'),url(https://fonts.gstatic.com/s/averiasanslibre/v8/ga6caxZG_G5OvCf_rt7FH3B6BHLMEdVLKjsVH5DdLw.ttf)format('truetype')}@font-face{font-family:averia sans libre;font-style:normal;font-weight:300;font-display:swap;src:local('Averia Sans Libre Light'),local('AveriaSansLibre-Light'),url(https://fonts.gstatic.com/s/averiasanslibre/v8/ga6SaxZG_G5OvCf_rt7FH3B6BHLMEd3lMJcXL5c.ttf)format('truetype')}@font-face{font-family:averia sans libre;font-style:normal;font-weight:400;font-display:swap;src:local('Averia Sans Libre Regular'),local('AveriaSansLibre-Regular'),url(https://fonts.gstatic.com/s/averiasanslibre/v8/ga6XaxZG_G5OvCf_rt7FH3B6BHLMEdVOEoc.ttf)format('truetype')}@font-face{font-family:averia sans libre;font-style:normal;font-weight:700;font-display:swap;src:local('Averia Sans Libre Bold'),local('AveriaSansLibre-Bold'),url(https://fonts.gstatic.com/s/averiasanslibre/v8/ga6SaxZG_G5OvCf_rt7FH3B6BHLMEd31N5cXL5c.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:italic;font-weight:400;font-display:swap;src:local('Source Code Pro Italic'),local('SourceCodePro-It'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_QiYsKILxRpg3hIP6sJ7fM7PqlONvUlMc.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:italic;font-weight:500;font-display:swap;src:local('Source Code Pro Medium Italic'),local('SourceCodePro-MediumIt'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_ViYsKILxRpg3hIP6sJ7fM7PqlONMnt9co5mg.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:italic;font-weight:600;font-display:swap;src:local('Source Code Pro SemiBold Italic'),local('SourceCodePro-SemiBoldIt'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_ViYsKILxRpg3hIP6sJ7fM7PqlONMLsNco5mg.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:italic;font-weight:700;font-display:swap;src:local('Source Code Pro Bold Italic'),local('SourceCodePro-BoldIt'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_ViYsKILxRpg3hIP6sJ7fM7PqlONNvsdco5mg.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:normal;font-weight:400;font-display:swap;src:local('Source Code Pro Regular'),local('SourceCodePro-Regular'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_SiYsKILxRpg3hIP6sJ7fM7PqlPevT.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:normal;font-weight:500;font-display:swap;src:local('Source Code Pro Medium'),local('SourceCodePro-Medium'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_XiYsKILxRpg3hIP6sJ7fM7PqtzsjDs-cv.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:normal;font-weight:600;font-display:swap;src:local('Source Code Pro SemiBold'),local('SourceCodePro-SemiBold'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_XiYsKILxRpg3hIP6sJ7fM7Pqt4s_Ds-cv.ttf)format('truetype')}@font-face{font-family:source code pro;font-style:normal;font-weight:700;font-display:swap;src:local('Source Code Pro Bold'),local('SourceCodePro-Bold'),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_XiYsKILxRpg3hIP6sJ7fM7Pqths7Ds-cv.ttf)format('truetype')}html{font-family:averia sans libre,-system-ui,-apple-system,BlinkMacSystemFont,helvetica neue,Helvetica,SimHei,segoe ui,Roboto,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol}code,pre,tt,kbd,samp{font-family:source code pro,Menlo,Consolas,liberation mono,monospace;font-weight:500}</style>
</head>

<body>
    <div class="wrapper"><section id="header" class="header">
        <div class="header-left"><a href="/"><p class="site-name">iPark memoization</p></a>
        </div>
        <div class="header-right"><div class="nav"><a class="nav-item" href="/tags/">Tags</a><a class="nav-item" href="/projects/">cs.Projects</a><a class="nav-item" href="/research/">bio.Research</a><a class="nav-item" href="/about/">resume</a><script>
  const htmlEl = document.getElementsByTagName('html')[0];
  const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
  if (currentTheme) {
    htmlEl.dataset.theme = currentTheme;
  }
  const toggleTheme = (theme) => {
    htmlEl.dataset.theme = theme;
    localStorage.setItem('theme', theme);
  }
  if (
    localStorage.getItem('theme') === 'dark' ||
    window.matchMedia &&
    window.matchMedia("(prefers-color-scheme: dark)").matches
  ) {
    htmlEl.dataset.theme = 'dark';
  } else {
    toggleTheme('light');
  }
</script>

<button 
    class="data-theme-btn dark-hidden"
    onclick="toggleTheme('dark');">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#3f4b67" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
</button>
<button 
    class="data-theme-btn light-hidden"
    onclick="toggleTheme('light');">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#e9e9e9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2m0 18v2M4.2 4.2l1.4 1.4m12.8 12.8l1.4 1.4M1 12h2m18 0h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"/></svg>
</button>
</div></div></section><section id="content"><div class="article-containter">
<section class="article-header">
    <h1>Image Recognition (MNIST dataset) in Keras</h1><p class="article-date">2021-06-24</p></section><section class="article-labels">
    <a class="article-tag li" href=/tags/dl/><span class="hashtag">#</span>DL</a><a class="article-tag li" href=/tags/deep-learning/><span class="hashtag">#</span>Deep Learning</a><a class="article-tag li" href=/tags/mnist/><span class="hashtag">#</span>mnist</a><a class="article-tag li" href=/tags/image-recognition/><span class="hashtag">#</span>image recognition</a><a class="article-tag li" href=/tags/keras/><span class="hashtag">#</span>keras</a></section><article class="markdown-body"><h2 id="image-recognition-mnist-dataset-in-keras">Image Recognition (MNIST dataset) in Keras</h2>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># tensorflow random seed set to reproduce later</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">tensorflow</span> <span style="color:#007020;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">tf</span>
<span style="color:#60a0b0;font-style:italic">#tf.random.set_seed(1234) # poor</span>
tf<span style="color:#666">.</span>random<span style="color:#666">.</span>set_seed(<span style="color:#40a070">1</span>) <span style="color:#60a0b0;font-style:italic"># poor</span>
</code></pre></div><h3 id="1-importing-and-reading-dataset">1) importing and reading dataset</h3>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">(train_ft, train_lb), (test_ft, test_lb) <span style="color:#666">=</span> \
                                        tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>datasets<span style="color:#666">.</span>mnist<span style="color:#666">.</span>load_data()
                                        <span style="color:#60a0b0;font-style:italic">#################</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">print</span>(f<span style="color:#4070a0">&#39;train_set:test_set={len(train_ft)}:{len(test_ft)}&#39;</span>)
</code></pre></div><pre><code>train_set:test_set=60000:10000
</code></pre>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># plot input data</span>
<span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">matplotlib.pyplot</span> <span style="color:#007020;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">plt</span>
fig_container <span style="color:#666">=</span> plt<span style="color:#666">.</span>figure(figsize<span style="color:#666">=</span>(<span style="color:#40a070">20</span>,<span style="color:#40a070">20</span>)) <span style="color:#60a0b0;font-style:italic"># .figure is top container</span>
nrows <span style="color:#666">=</span> <span style="color:#40a070">1</span>
ncols <span style="color:#666">=</span> <span style="color:#40a070">5</span>
<span style="color:#007020;font-weight:bold">for</span> i <span style="color:#007020;font-weight:bold">in</span> <span style="color:#007020">range</span>(ncols):
    <span style="color:#60a0b0;font-style:italic"># subplot(nrows, ncols, index, **kwargs)</span>
    ax <span style="color:#666">=</span> fig_container<span style="color:#666">.</span>add_subplot(nrows, ncols, i<span style="color:#666">+</span><span style="color:#40a070">1</span>) 
    ax<span style="color:#666">.</span>imshow(train_ft[i], cmap<span style="color:#666">=</span><span style="color:#4070a0">&#39;Greys&#39;</span>)
    ax<span style="color:#666">.</span>set_title(<span style="color:#4070a0">&#39;label=&#39;</span> <span style="color:#666">+</span> <span style="color:#007020">str</span>(train_lb[i]))
</code></pre></div><img src="/img/MNIST/output_5_0.png" width="500">
<h3 id="2-preprocessing-data">2) preprocessing data</h3>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># input flatten</span>
train_ft[<span style="color:#40a070">0</span>]<span style="color:#666">.</span>shape <span style="color:#60a0b0;font-style:italic"># (28, 28)</span>
train_ft_flat <span style="color:#666">=</span> train_ft<span style="color:#666">.</span>reshape(<span style="color:#666">-</span><span style="color:#40a070">1</span>, <span style="color:#40a070">28</span><span style="color:#666">*</span><span style="color:#40a070">28</span>)
test_ft_flat <span style="color:#666">=</span> test_ft<span style="color:#666">.</span>reshape(<span style="color:#666">-</span><span style="color:#40a070">1</span>, <span style="color:#40a070">28</span><span style="color:#666">*</span><span style="color:#40a070">28</span>)
</code></pre></div><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># categorize</span>
num_classes <span style="color:#666">=</span> <span style="color:#007020">len</span>(<span style="color:#007020">set</span>(train_lb))
<span style="color:#007020;font-weight:bold">print</span>(num_classes)
<span style="color:#60a0b0;font-style:italic"># one-hot-encode</span>
train_lb_cat <span style="color:#666">=</span> tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>utils<span style="color:#666">.</span>to_categorical(train_lb, num_classes) 
test_lb_cat <span style="color:#666">=</span> tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>utils<span style="color:#666">.</span>to_categorical(test_lb, num_classes) 
               <span style="color:#60a0b0;font-style:italic">##############</span>
</code></pre></div><pre><code>10
</code></pre>
<h3 id="3-building-neural-network-model">3) building neural network model</h3>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># build a model</span>
model <span style="color:#666">=</span> tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>models<span style="color:#666">.</span>Sequential()
model<span style="color:#666">.</span>add( tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dense(<span style="color:#40a070">128</span>, activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, \
                                      input_shape<span style="color:#666">=</span>(<span style="color:#40a070">28</span><span style="color:#666">*</span><span style="color:#40a070">28</span>,)) ) <span style="color:#60a0b0;font-style:italic"># input</span>
model<span style="color:#666">.</span>add( tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dropout(<span style="color:#40a070">0.2</span>) )
model<span style="color:#666">.</span>add( tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dense(<span style="color:#40a070">64</span>, activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>) )
model<span style="color:#666">.</span>add( tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dropout(<span style="color:#40a070">0.2</span>) )
model<span style="color:#666">.</span>add( tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dense(num_classes, \
                                    activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;softmax&#39;</span>) ) <span style="color:#60a0b0;font-style:italic"># output</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># compile a model with specific optimizer, loss, and monitoring metric</span>
model<span style="color:#666">.</span>compile(optimizer<span style="color:#666">=</span>tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>optimizers<span style="color:#666">.</span>Adam(), \
                       <span style="color:#60a0b0;font-style:italic">#tf.keras.optimizers.RMSprop(0.01), </span>
              loss<span style="color:#666">=</span>tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>losses<span style="color:#666">.</span>CategoricalCrossentropy(),
              metrics<span style="color:#666">=</span>[tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>metrics<span style="color:#666">.</span>CategoricalAccuracy()])
<span style="color:#60a0b0;font-style:italic">#model.compile( optimizer=&#39;adam&#39;, \</span>
                loss<span style="color:#666">=</span><span style="color:#4070a0">&#39;categorical_crossentropy&#39;</span>, \
                metrics<span style="color:#666">=</span>[<span style="color:#4070a0">&#39;accuracy&#39;</span>])
model<span style="color:#666">.</span>summary()
</code></pre></div><pre><code>Model: &quot;sequential_8&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_20 (Dense)             (None, 128)               100480    
_________________________________________________________________
dropout_14 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_21 (Dense)             (None, 64)                8256      
_________________________________________________________________
dropout_15 (Dropout)         (None, 64)                0         
_________________________________________________________________
dense_22 (Dense)             (None, 10)                650       
=================================================================
Total params: 109,386
Trainable params: 109,386
Non-trainable params: 0
_________________________________________________________________
</code></pre>
<h3 id="4-training-neural-network">4) training neural network</h3>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># training fit to **train_set** using specific epochs &amp; batch_size</span>
model<span style="color:#666">.</span>fit(train_ft_flat, train_lb_cat, epochs<span style="color:#666">=</span><span style="color:#40a070">3</span>, batch_size<span style="color:#666">=</span><span style="color:#40a070">20</span>)
</code></pre></div><pre><code>Epoch 1/3
3000/3000 [==============================] - 6s 2ms/step - loss: 2.3589 - categorical_accuracy: 0.6836
Epoch 2/3
3000/3000 [==============================] - 6s 2ms/step - loss: 0.6324 - categorical_accuracy: 0.8352
Epoch 3/3
3000/3000 [==============================] - 6s 2ms/step - loss: 0.4446 - categorical_accuracy: 0.8817

&lt;tensorflow.python.keras.callbacks.History at 0x15bfd2550&gt;
</code></pre>
<h3 id="5-evaluation-model">5) evaluation model</h3>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># prediction using test set</span>
predict_vec <span style="color:#666">=</span> model<span style="color:#666">.</span>predict(test_ft_flat)
</code></pre></div><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">numpy</span> <span style="color:#007020;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">np</span>
predictions <span style="color:#666">=</span> [np<span style="color:#666">.</span>argmax(p) <span style="color:#007020;font-weight:bold">for</span> p <span style="color:#007020;font-weight:bold">in</span> predict_vec]
</code></pre></div><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># plot prediction vs. true label</span>
<span style="color:#007020;font-weight:bold">print</span>(f<span style="color:#4070a0">&#39;true label={test_lb[4]}&#39;</span>)
<span style="color:#007020;font-weight:bold">print</span>(f<span style="color:#4070a0">&#39;predict label={predictions[4]}&#39;</span>)
plt<span style="color:#666">.</span>imshow(test_ft[<span style="color:#40a070">4</span>], cmap<span style="color:#666">=</span><span style="color:#4070a0">&#39;Greys&#39;</span>)
</code></pre></div><pre><code>true label=4
predict label=4

&lt;matplotlib.image.AxesImage at 0x15532ee80&gt;
</code></pre>
<img src="/img/MNIST/output_17_2.png" width="100">
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#60a0b0;font-style:italic"># accuracy</span>
correct_num <span style="color:#666">=</span> <span style="color:#40a070">0</span>
<span style="color:#007020;font-weight:bold">for</span> i, p <span style="color:#007020;font-weight:bold">in</span> <span style="color:#007020">enumerate</span>(predictions):
    <span style="color:#007020;font-weight:bold">if</span> test_lb[i] <span style="color:#666">==</span> p:
        correct_num <span style="color:#666">+=</span> <span style="color:#40a070">1</span>
<span style="color:#007020;font-weight:bold">print</span>(f<span style="color:#4070a0">&#39;model accuracy = {correct_num/len(predictions)}&#39;</span>)
    
</code></pre></div><pre><code>model accuracy = 0.9067
</code></pre>
</article>
</div><section class="article-navigation"><p><a class="link" href="/ai/regression-using-neural-network-in-keras-boston-hyderabad-dataset/"><span class="li"></span>Regression using Neural Network in Keras (Boston, Hyderabad dataset)</a></p><p><a class="link" href="/ai/deep-learning-for-time-series/"><span class="li"></span>Deep Learning for Time Series</a class="link">
    </p></section></section><section id="footer" class="footer max-body-width"><div class="footer-wrap"><p class="copyright">iPark memoization</p></div>
<div class="footer-wrap"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a><span> | </span><a href="/index.xml" target="_blank" rel="noopener"> RSS</a></div>
<div class="footer-wrap"><p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
    target="_blank" rel="noopener">Hugo</a><span> and the </span><a href="https://github.com/qdzhang/hugo-notepadium-mod" 
    target="_blank" rel="noopener">Notepadium-mod</a></p></div>
<div class="footer-wrap">
    <a onclick='window.scrollTo({top: 0, behavior: "smooth"});'>^ TOP ^</a>
</div></section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script></div>
</body>

</html>